<style>
  .free-shipping-progress {
    margin: 15px 0;
    text-align: center;
    font-size: 14px;
  }

  .progress-bar {
    height: 9px;
    border-radius: 8px;
    background: #E1E1E1;
    overflow: hidden;
    margin-bottom: 20px; /* leave space for icons */
    position: relative;
  }

  .progress-fill {
    height: 100%;
    background: #D8BBD6;
    border-radius: 8px;
    width: 0;
    transition: width 0.4s ease;
    display: block !important;
  }

  /* Milestone icons */
  .milestone {
    position: absolute;
    top: 14px; /* place below the bar */
    transform: translateX(-50%);
    font-size: 16px;
  }
</style>

{% assign free_shipping_threshold = settings.free_shipping_threshold | times: 100 %}
{% assign free_gift_threshold = settings.free_gift_threshold | times: 100 %}
{% assign cart_total = cart.total_price %}

<div class="free-shipping-progress">
  <div class="progress-bar">
    <div
      class="progress-fill"
      style="width: {{ cart_total | times: 100 | divided_by: free_gift_threshold | at_most: 100 }}%;"
    ></div>

    <!-- Milestone markers -->
    <span
      class="milestone"
      style="left: {{ free_shipping_threshold | times: 100 | divided_by: free_gift_threshold }}%;"
    >
      ğŸšš
    </span>
    <span class="milestone" style="left: 100%;">ğŸ</span>
  </div>

  <p class="progress-text">
    {% if cart_total >= free_gift_threshold %}
      ğŸ Congrats! You unlocked <strong>Free Gift + Free Shipping</strong>!
    {% elsif cart_total >= free_shipping_threshold %}
      ğŸšš You unlocked <strong>Free Shipping</strong> â€” add
      <strong>{{ free_gift_threshold | minus: cart_total | money }}</strong> more to get a Free Gift!
    {% else %}
      Add <strong>{{ free_shipping_threshold | minus: cart_total | money }}</strong> to unlock
      <strong>Free Shipping</strong>.
    {% endif %}
  </p>
</div>
